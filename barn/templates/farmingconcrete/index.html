{% extends "base.html" %}
{% load static %}

{% block title %}Home{% endblock %}

{% block head %}
    {% if not is_mobile %}
        <script src="{% static "lib/OpenLayers/OpenLayers.js" %}" type="text/javascript"></script>
        <script src="{% static "js/cloudmade.js" %}" type="text/javascript"></script>
        <script src="{% static "js/jquery-util.js" %}" type="text/javascript"></script>
        <script src="{% static "js/map.js" %}" type="text/javascript"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                $('#map').gardenmap({
                    queryString: 'participating=yes&year={{ request.session.year }}',
                });
            });   
        </script>
    {% endif %}
{% endblock %}

{% block content %}
    {% if not is_mobile %}
        {% if not user.is_authenticated %}
            <p>
                This is the 
                <a href="http://farmingconcrete.org">Farming Concrete</a> Barn,
                where we store our data.
            </p>

            <p>
                If you are a gardener and would like to start entering data, 
                please 
                <a href="{% url "django.contrib.auth.views.login" %}" data-role="button">log in</a> 
                first. If you don't yet have a login, you can 
                <a href="{% url "registration_register" %}">create one now</a>
                If you are just visiting, we will eventually have some public 
                reports here for you to view.
            </p>

            <p>
                If you have any problems or questions, please email us at 
                <strong>gardens (at) farmingconcrete (dot) org</strong>.
            </p>

            <p>
                <a class="btn btn-default" href="{% url "registration_register" %}">
                    Register
                </a>
                <a class="btn btn-primary" href="{% url "django.contrib.auth.views.login" %}">
                    Log in
                </a>
            </p>

        {% else %}
            <div id="left">
                <p>This is the <a href="http://farmingconcrete.org">Farming Concrete</a> Barn, where we store our data.</p>

                <p>There are a few things you can do here:
                    <ul>
                        <li><a href="{% url "cropcount.views.index" %}">Crop Count</a>: how many beds does your garden have? and how many plants are in them?</li>
                        <li><a href="{% url "harvestcount.views.index" %}">Harvest Count</a>: how much food are your plants producing?</li>
                    </ul>
                </p>

                {% if user_gardens %}
                <p>You have access to the following garden{{ user_gardens|pluralize }}:
                    <ul>
                        {% for garden in user_gardens %}
                        <li>
                        <a href="{% url "farmingconcrete.views.garden_details" id=garden.id %}">{{ garden.name }}</a>
                            <ul>
                                <li><a href="{% url "cropcount.views.garden_details" id=garden.id %}">view crop count</a></li>
                                <li><a href="{% url "harvestcount.views.garden_details" id=garden.id %}">view harvest count</a></li>
                            </ul>
                        </li>
                        {% endfor %}
                    </ul>
                </p>
                {% endif %}

                <p>If you have any problems or questions, please email us at <strong>gardens (at) farmingconcrete (dot) org</strong>.<p>
            </div>
            <div id="right">
                <div id="map" style="width: 400px; height: 300px;"></div>
            </div>
        {% endif %}
    {% else %}
        <div id="logo"></div>
        <h1 style="width: 100%; text-align: center;">Farming Concrete Barn</h1>
        <div>
            <ul data-role="listview" data-inset="true">
                {% if user.is_authenticated %}
                <li><a href="{% url "farmingconcrete_gardens_yours" %}">Your Gardens</a></li>
                <li><a href="{% url "farmingconcrete_gardens" %}">Find a Garden</a></li>
                <li><a href="{% url "django.contrib.auth.views.logout" %}">Logout</a></li>
                {% else %}
                <li><a href="{% url "django.contrib.auth.views.login" %}">Login</a></li>
                {% endif %}
            </ul>
            <ul data-role="listview" data-inset="true">
            </ul>
            <div class="clear"></div>
        </div>
    {% endif %}
{% endblock %}

{% if is_mobile %}
    {% block header %}{% endblock %}
    {% block footer %}{% endblock %}
{% endif %}
