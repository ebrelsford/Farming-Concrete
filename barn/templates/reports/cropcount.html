<div>
    <h2>Crop Count</h2>
    {% if beds %}

    {% if garden %}
    <div class="beds section collapsible collapsed">
        <h3 class="expander"><a href="#">Click to show/hide full crop count</a></h3>
        <div class="expandee">
        {% include "metrics/cropcount/gardens/snippet.html" %}
        </div>
    </div>
    {% endif %}

    <div class="totals section">
        <h3>Totals</h3>
        <table class="totals cycled">
            {% if cropcount_gardens_count %}
            <tr class="even">
                <th>participating gardens</th>
                <td class="number">{{ cropcount_gardens_count }}</td>
            </tr>
            {% endif %}
            <tr class="even">
                <th>distinct varieties</th>
                <td class="number">{{ cropcount_varieties_count }}</td>
            </tr>
            <tr class="odd">
                <th>number of beds</th>
                <td class="number">{{ total_beds }}</td>
            </tr>
            <tr class="even">
                <th>area under production</th>
                <td class="number">{{ total_area|floatformat }} sq ft</td>
            </tr>
            <tr class="odd">
                <th>plants</th>
                <td class="number">{{ total_plants }}</td>
            </tr>
            <tr class="even">
                <th>plants with estimated yields</th>
                <td class="number">{{ total_plants_with_yields }}</td>
            </tr>
            {% if total_estimated_yield %}
            <tr class="odd">
                <th>estimated yield</th>
                <td class="number">{{ total_estimated_yield|floatformat }} lbs</td>
            </tr>
            <tr class="even">
                <th>estimated yield per square foot</th>
                <td class="number">{{ total_estimated_yield_by_area|floatformat }} lbs</td>
            </tr>
            {% endif %}
            {% if total_estimated_yield_type %}
            <tr class="odd">
                <th>estimated yield using {{ type }} yields</th>
                <td class="number">{{ total_estimated_yield_type|floatformat }} lbs</td>
            </tr>
            {% endif %}
            {% if total_estimated_value %}
            <tr class="even">
                <th>estimated value</th>
                <td class="number">${{ total_estimated_value|floatformat:"0" }}</td>
            </tr>
            {% endif %}
            {% if total_estimated_value_type %}
            <tr class="odd">
                <th>estimated value using {{ type }} yields</th>
                <td class="number">${{ total_estimated_value_type|floatformat:"0" }}</td>
            </tr>
            {% endif %}
        </table>

        <h4>plants per crop</h4>
        <table class="sorted">
            <thead>
                <tr>
                    <th>plant type</th>
                    <th>plants</th>
                    <th>area</th>
                    {% if not garden %}
                    <th>avg yield overall<br />(lbs per plant)</th>
                    {% endif %}
                    <th>estimated yield (lbs)</th>
                    <th>estimated value</th>
                    {% if not garden and type %}
                    <th>avg yield for {{ type.name }}s<br />(lbs per plant)</th>
                    <th>estimated yield using {{ type.name }}s avg<br />(lbs per plant)</th>
                    <th>estimated value using {{ type.name }}s avg</th>
                    {% endif %}
                </tr>
            </thead>
            <tbody>
                {% for crop in variety_totals %}
                <tr>
                    <td class="number">{{ crop.name }}</td>
                    <td class="number">{{ crop.plants|default:"" }}</td>
                    <td class="number">{{ crop.area|default:"" }}</td>
                    {% if not garden %}
                    <td class="number average-yield" data-crop-name="{{ crop.name }}" data-year="{{ year }}">{{ crop.average_yield|default:"" }}</td>
                    {% endif %}
                    <td class="number">{{ crop.estimated_yield|default:"" }}</td>
                    <td class="number">{% if crop.value %}${{ crop.value|floatformat:"0" }}{% endif %}</td>
                    {% if not garden and type %}
                    <td class="number">{{ crop.type_average_yield|default:"" }}</td>
                    <td class="number">{{ crop.type_estimated_yield|default:"" }}</td>
                    <td class="number">{% if crop.type_estimated_value %}${{ crop.type_estimated_value|floatformat:"0" }}{% endif %}</td>
                    {% endif %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% if garden %}
        <img src="{% url "reports.views.bar_chart_plants_per_crop" id=garden.id year=year %}" />
        {% endif %}
    </div>
    {% else %}
    No crop count available.
    {% endif %}
</div>
