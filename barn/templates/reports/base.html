{% extends "base.html" %}
{% load i18n %}

{% block body_class %}{{ block.super }} reports-page{% endblock %}

{% block breadcrumbs %}
    <a href="{% url "home" %}">Home</a> &gt;&gt; 
{% endblock %}

{% block content %}

    {% block page_title %}{% endblock %}

    <div id="map" style="width: 100%; height: 300px;"
        {% block map_options %}
            data-l-zoom="8"
            data-l-center="[40.71, -73.98]"
            data-l-mapbox-id="farmingconcrete.i29og38a"
        {% endblock %}
    ></div>

    {% if not garden %}
        <section>
            <form class="form-inline" role="form">

                <div class="form-group">
                    <label class="sr-only" for="garden-type">
                        garden type:
                    </label>
                    <select id="garden-type" class="form-control filter" name="type">
                        <option value="all">all garden types</option>
                        {% for select_type in garden_types %}
                            <option value="{{ select_type.short_name }}"{% if type.short_name == select_type.short_name %} selected="selected"{% endif %}>
                                {{ select_type.name }}s
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <label class="sr-only" for="year">
                        year:
                    </label>
                    <select id="year" class="form-control filter" name="year">
                        <option value="all">all years</option>
                        {% for select_year in years %}
                            <option value="{{ select_year }}" {% if year == select_year %}selected="selected"{% endif %}>
                                {{ select_year }}
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <label class="sr-only" for="metric">
                        metric:
                    </label>
                    <select id="metric" class="form-control filter" name="metric">
                        <option value="all">all metrics</option>
                        {% for group_name, metric_list in metrics.items %}
                            <optgroup label="{{ group_name }}">
                                {% for select_metric in metric_list %}
                                    <option value="{{ select_metric.name }}"{% if metric == select_metric.name %} selected="selected"{% endif %}>
                                        {{ select_metric.name }}
                                    </option>
                                {% endfor %}
                            </optgroup>
                        {% endfor %}
                    </select>
                </div>

                <button type="submit" class="btn btn-default">{% trans "Update report" %}</button>

            </form>
        </section>
    {% endif %}

    <section class="report-output">
        {# TODO look for metric-specific report first #}
        {% include "reports/overall.html" %}
    </section>
{% endblock %}

{% block actions %}{% endblock %}
