{% load compress static %}

<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Farming Concrete (Barn): {% block title %}{% endblock %}</title>

        <link rel="icon" href="{% static "img/favicon.ico" %}" />
        <link rel="shortcut icon" href="{% static "img/favicon.ico" %}" />

        {% compress css %}
            <link rel="stylesheet" type="text/css" href="{% static "bower_components/bootstrap/dist/css/bootstrap.css" %}" />
            <link rel="stylesheet" type="text/css" href="{% static "bower_components/bootstrap/dist/css/bootstrap-theme.css" %}" />
            <link rel="stylesheet" type="text/css" href="{% static "css/style.css" %}" />
            <link rel="stylesheet" type="text/css" href="{% static "lib/jquery.autocomplete.css" %}" />
        {% endcompress %}

        {% compress js %}
            <script src="{% static "js/jquery-util.js" %}" type="text/javascript"></script>
            <script src="{% static "js/farmingconcrete.js" %}" type="text/javascript"></script>

            <script src="{% static "lib/jquery.autocomplete.min.js" %}" type="text/javascript"></script>
            <script src="{% static "lib/ajax_select.js" %}" type="text/javascript"></script>
        {% endcompress %}

        {% include "_common_includes.html" %}

        {% block head %}{% endblock %}
    </head>
    <body class="col-lg-10 col-lg-offset-1 col-sm-10 col-sm-offset-1 {% block body_class %}{% endblock %}">
        <div data-role="page">

            {% if user.is_authenticated %}
                <div id="feedback">
                    <div id="feedback-form">
                        {% include "feedback/feedback_form.html" %}
                    </div>
                    <div id="feedback-button">
                        Feedback
                    </div>
                </div>
            {% endif %}

            <div id="header" data-role="header">
                <a href="{% url "home" %}"><img src="{% static "img/header.jpg" %}" /></a>
            </div>

            <div id="nav" class="navbar">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="{% url "home" %}">Home</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            Metrics
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            {% for group, metrics in grouped_metrics.items %}

                                {% if group %}
                                    <li role="presentation" class="dropdown-header">
                                        {{ group }}
                                    </li>
                                {% endif %}

                                {% for metric in metrics %}
                                    <li>
                                        <a href="{% url metric.index_url_name %}">
                                            {{ metric.name }}
                                        </a>
                                    </li>
                                {% endfor %}

                                {% if not forloop.last %}
                                    <li role="presentation" class="divider"></li>
                                {% endif %}

                            {% endfor %}
                        </ul>
                    </li>
                    {% if user.is_staff %}
                    <li><a href="{% url "reports.views.index" %}">Reports</a></li>

                    <li><a href="/admin">Admin</a></li>
                    {% endif %}

                    {% if user.is_authenticated %}
                    <li><a href="{% url "farmingconcrete.views.account" %}">Your account</a></li>
                    <li><a href="{% url "django.contrib.auth.views.logout" %}">Logout</a></li>
                    {% else %}
                    <li><a href="{% url "django.contrib.auth.views.login" %}">Login</a></li>
                    {% endif %}

                    <li><a href="http://farmingconcrete.org">Blog</a></li>
                </ul>
            </div>

            <div id="main" data-role="content">
                <div id="breadcrumbs">
                    {% block breadcrumbs %}{% endblock %}
                </div>
                <div id="content">

                    {% if messages %}
                        {% for message in messages %}
                            <div{% if message.tags %} class="alert alert-{{ message.tags }}"{% endif %}>{{ message }}</div>
                        {% endfor %}
                    {% endif %}

                    {% block content %}{% endblock %}
                    <div id="bottom" style="clear: both;">
                        {% block actions %}{% endblock %}
                    </div>
                </div>
            </div>

            <div data-role="footer">
            </div>

            {% block popup_template %}
                {% verbatim %}
                    <script id="popup-template" type="text/x-handlebars-template">
                        <div class="garden-popup">
                            <div class="garden-popup-name">
                                <a href="{{url}}" target="_blank">
                                    {{garden.properties.name}}
                                </a>
                            </div>
                        </div>
                    </script>
                {% endverbatim %}
            {% endblock %}

        </div>
    </body>
</html>
