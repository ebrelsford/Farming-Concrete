{% extends "cropcount/map_base.html" %}

{% block title %}{{ garden.name }}{% endblock %}

{% block map_params %}
type: 'single',
id: {{ garden.id }},   
{% endblock %}

{% block head %}
{{ block.super }}
<script src="{{ MEDIA_URL }}js/help.js" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function() {
    $('a.delete').click(function(event) {
        if (!confirm("Are you sure you want to delete this bed?")) {
            return false;
        }
    });

    $('#number_help').help({ text: 'Enter the number for this bed. If you do not have a number for the bed, the default given should be okay.' });
    $('#dimensions_help').help({ text: 'Enter the dimensions for this bed. This helps us determine how much space is being used to grow food.' });
});   
</script>
{% endblock %}

{% block breadcrumbs %}{{ block.super }}<a href="{% url farmingconcrete.views.garden_details id=garden.id %}">{{ garden.name }}</a> &gt;&gt; crop count{% endblock %}

{% block content %}
{% if garden %}
    <h1>{{ garden.name }}</h1>

    <div class="garden-details">
    {{ block.super }}
    </div>

    <div id="bottom" style="clear: both;">
        <div id="no-more-beds" class="complete">
        </div>
    </div>
{% else %}
    <p>No such garden</p>
{% endif %}
{% endblock %}

{% block left %}
<div id="new-bed" style="border-bottom: 2px solid black; margin-bottom: 10px;">
    <span style="font-weight: bold;">Add a new bed to this garden</span>
    <form method="post" action=".">
        {% csrf_token %}
        {% for hidden in form.hidden_fields %}
        {{ hidden }}
        {% endfor %}
        <div id="errors">
            {{ form.non_field_errors }}
            {{ form.garden.errors }}{{ form.name.errors }}{{ form.width.errors }}{{ form.length.errors }}
        </div>
        <div id="inputs">
            <div>
                <label for="id_name">{{ form.name.label }}:</label> {{ form.name }} <span id="number_help" class="help_link"></span><br />
            </div>
            <div>
                <label for="id_width">{{ form.width.label }}:</label> {{ form.width }}ft x {{ form.length }}ft <span id="dimensions_help" class="help_link"></span>
            </div>
            <input type="submit" value="add" />
        </div>
    </form>
</div>
<div id="beds">
    <span style="font-weight: bold;">Current beds in this garden for {{ request.session.year }}</span>
    {% if bed_list %}
    <ul class="values">
        {% for month in bed_months %}
        <li class="month">
            <span class="month-name">Added in {{ month }}</span>
            <ul class="values">
            {% for box in bed_list %}
                {% with m=box.added|date:"F" %}
                {% if m == month %}
                <li class="bed">
                {% include "cropcount/gardens/detail_bed_snippet.html" %}
                </li>
                {% endif %}
                {% endwith %}
            {% endfor %}
            </ul>
        </li>
        {% endfor %}
    </ul>
    {% else %}
    <p>No beds yet.</p>
    {% endif %}
</div>
{% endblock %}

{% block right %}
<ul class="overview">
    <li><b>{{ beds|default:"0" }}</b> bed{{ beds|pluralize }}</li>
    <li><b>{{ area|default:"0" }}</b> square feet</li>
    <li><b>{{ plants|default:"0" }}</b> plant{{ plants|pluralize }}</li>
</ul>

{% endblock %}

{% block actions %}
<h2>
    <a class="image" href="{% url cropcount.views.download_garden_cropcount_as_csv id=garden.id year=request.session.year %}"><img src="{{ MEDIA_URL }}img/download.png" /></a>
    <a class="text" href="{% url cropcount.views.download_garden_cropcount_as_csv id=garden.id year=request.session.year %}">Download this as a spreadsheet</a>
</h2>
<h2>
    <a class="image" href="{% url harvestcount.views.garden_details id=garden.id %}"><img src="{{ MEDIA_URL }}img/round_arrow_right.png" /></a>
    <a class="text" href="{% url harvestcount.views.garden_details id=garden.id %}">Switch to Harvest Count</a>
</h2>
{{ block.super }}
<h2>
    <a class="image" href="{% url cropcount.views.user_gardens year=request.session.year %}"><img src="{{ MEDIA_URL }}img/round_checkmark.png" /></a>
    <a class="text" href="{% url cropcount.views.user_gardens year=request.session.year %}">Done adding beds to this garden!</a>
</h2>
{% endblock %}
